{"ast":null,"code":"import \"core-js/modules/es.error.cause.js\";\n\nfunction getError(option, xhr) {\n  var msg = 'cannot ' + option.method + ' ' + option.action + ' ' + xhr.status + '\\'';\n  var err = new Error(msg);\n  err.status = xhr.status;\n  err.method = option.method;\n  err.url = option.action;\n  return err;\n}\n\nfunction getBody(xhr) {\n  var text = xhr.responseText || xhr.response;\n\n  if (!text) {\n    return text;\n  }\n\n  try {\n    return JSON.parse(text);\n  } catch (e) {\n    return text;\n  }\n} // option {\n//  onProgress: (event: { percent: number }): void,\n//  onError: (event: Error, body?: Object): void,\n//  onSuccess: (body: Object): void,\n//  data: Object,\n//  filename: String,\n//  file: File,\n//  withCredentials: Boolean,\n//  action: String,\n//  headers: Object,\n// }\n\n\nexport default function upload(option) {\n  var xhr = new window.XMLHttpRequest();\n\n  if (option.onProgress && xhr.upload) {\n    xhr.upload.onprogress = function progress(e) {\n      if (e.total > 0) {\n        e.percent = e.loaded / e.total * 100;\n      }\n\n      option.onProgress(e);\n    };\n  }\n\n  var formData = new window.FormData();\n\n  if (option.data) {\n    Object.keys(option.data).forEach(function (key) {\n      var value = option.data[key]; // support key-value array data\n\n      if (Array.isArray(value)) {\n        value.forEach(function (item) {\n          // { list: [ 11, 22 ] }\n          // formData.append('list[]', 11);\n          formData.append(key + '[]', item);\n        });\n        return;\n      }\n\n      formData.append(key, option.data[key]);\n    });\n  }\n\n  formData.append(option.filename, option.file);\n\n  xhr.onerror = function error(e) {\n    option.onError(e);\n  };\n\n  xhr.onload = function onload() {\n    // allow success when 2xx status\n    // see https://github.com/react-component/upload/issues/34\n    if (xhr.status < 200 || xhr.status >= 300) {\n      return option.onError(getError(option, xhr), getBody(xhr));\n    }\n\n    option.onSuccess(getBody(xhr), xhr);\n  };\n\n  xhr.open(option.method, option.action, true); // Has to be after `.open()`. See https://github.com/enyo/dropzone/issues/179\n\n  if (option.withCredentials && 'withCredentials' in xhr) {\n    xhr.withCredentials = true;\n  }\n\n  var headers = option.headers || {}; // when set headers['X-Requested-With'] = null , can close default XHR header\n  // see https://github.com/react-component/upload/issues/33\n\n  if (headers['X-Requested-With'] !== null) {\n    xhr.setRequestHeader('X-Requested-With', 'XMLHttpRequest');\n  }\n\n  for (var h in headers) {\n    if (headers.hasOwnProperty(h) && headers[h] !== null) {\n      xhr.setRequestHeader(h, headers[h]);\n    }\n  }\n\n  xhr.send(formData);\n  return {\n    abort: function abort() {\n      xhr.abort();\n    }\n  };\n}","map":{"version":3,"names":["getError","option","xhr","msg","method","action","status","err","Error","url","getBody","text","responseText","response","JSON","parse","e","upload","window","XMLHttpRequest","onProgress","onprogress","progress","total","percent","loaded","formData","FormData","data","Object","keys","forEach","key","value","Array","isArray","item","append","filename","file","onerror","error","onError","onload","onSuccess","open","withCredentials","headers","setRequestHeader","h","hasOwnProperty","send","abort"],"sources":["D:/Desktop/大三上/实训/项目2.0/xbr/前端/node_modules/ant-design-vue/es/vc-upload/src/request.js"],"sourcesContent":["function getError(option, xhr) {\r\n  var msg = 'cannot ' + option.method + ' ' + option.action + ' ' + xhr.status + '\\'';\r\n  var err = new Error(msg);\r\n  err.status = xhr.status;\r\n  err.method = option.method;\r\n  err.url = option.action;\r\n  return err;\r\n}\r\n\r\nfunction getBody(xhr) {\r\n  var text = xhr.responseText || xhr.response;\r\n  if (!text) {\r\n    return text;\r\n  }\r\n\r\n  try {\r\n    return JSON.parse(text);\r\n  } catch (e) {\r\n    return text;\r\n  }\r\n}\r\n\r\n// option {\r\n//  onProgress: (event: { percent: number }): void,\r\n//  onError: (event: Error, body?: Object): void,\r\n//  onSuccess: (body: Object): void,\r\n//  data: Object,\r\n//  filename: String,\r\n//  file: File,\r\n//  withCredentials: Boolean,\r\n//  action: String,\r\n//  headers: Object,\r\n// }\r\nexport default function upload(option) {\r\n  var xhr = new window.XMLHttpRequest();\r\n\r\n  if (option.onProgress && xhr.upload) {\r\n    xhr.upload.onprogress = function progress(e) {\r\n      if (e.total > 0) {\r\n        e.percent = e.loaded / e.total * 100;\r\n      }\r\n      option.onProgress(e);\r\n    };\r\n  }\r\n\r\n  var formData = new window.FormData();\r\n\r\n  if (option.data) {\r\n    Object.keys(option.data).forEach(function (key) {\r\n      var value = option.data[key];\r\n      // support key-value array data\r\n      if (Array.isArray(value)) {\r\n        value.forEach(function (item) {\r\n          // { list: [ 11, 22 ] }\r\n          // formData.append('list[]', 11);\r\n          formData.append(key + '[]', item);\r\n        });\r\n        return;\r\n      }\r\n\r\n      formData.append(key, option.data[key]);\r\n    });\r\n  }\r\n\r\n  formData.append(option.filename, option.file);\r\n\r\n  xhr.onerror = function error(e) {\r\n    option.onError(e);\r\n  };\r\n\r\n  xhr.onload = function onload() {\r\n    // allow success when 2xx status\r\n    // see https://github.com/react-component/upload/issues/34\r\n    if (xhr.status < 200 || xhr.status >= 300) {\r\n      return option.onError(getError(option, xhr), getBody(xhr));\r\n    }\r\n\r\n    option.onSuccess(getBody(xhr), xhr);\r\n  };\r\n\r\n  xhr.open(option.method, option.action, true);\r\n\r\n  // Has to be after `.open()`. See https://github.com/enyo/dropzone/issues/179\r\n  if (option.withCredentials && 'withCredentials' in xhr) {\r\n    xhr.withCredentials = true;\r\n  }\r\n\r\n  var headers = option.headers || {};\r\n\r\n  // when set headers['X-Requested-With'] = null , can close default XHR header\r\n  // see https://github.com/react-component/upload/issues/33\r\n  if (headers['X-Requested-With'] !== null) {\r\n    xhr.setRequestHeader('X-Requested-With', 'XMLHttpRequest');\r\n  }\r\n\r\n  for (var h in headers) {\r\n    if (headers.hasOwnProperty(h) && headers[h] !== null) {\r\n      xhr.setRequestHeader(h, headers[h]);\r\n    }\r\n  }\r\n  xhr.send(formData);\r\n\r\n  return {\r\n    abort: function abort() {\r\n      xhr.abort();\r\n    }\r\n  };\r\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}